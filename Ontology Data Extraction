---
title: "Ontology Data Extraction"
author: "Ursula Podosenin"
date: "2024-05-01"
output: html_document
---

# Loading the  necessary packages
install.packages("httr")
library(httr)

# Defining the function to get code from EBI OLS API
get_code_from_api <- function(url) {
  response <- GET(url)
  if (http_error(response)) {
    stop("Error in getting code")
  }
  parsed_response <- content(response, "parsed")
  code <- parsed_response$obo_id
  return(code)
}

# Getting the code from the link
url <- "https://www.ebi.ac.uk/ols/api/ontologies/mondo/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FMONDO_0005180"
code <- get_code_from_api(url)
print(code)

# Defining the function to extract direct children
extract_direct_children <- function(data, term_id) {
  if (!is.null(data$ontologies$mondo$terms[[term_id]]$children)) {
    children <- data$ontologies$mondo$terms[[term_id]]$children
    children_df <- data.frame(code = children, name = unlist(lapply(children, function(child) data$ontologies$mondo$terms[[child]]$label)))
    return(children_df)
  } else {
    return(NULL)
  }
}

# Extracting the direct children of Parkinson Disease 
data <- jsonlite::fromJSON(gzfile("/Users/ursulapodosenin/Desktop/ontologies.json.gz"))
parkinson_children <- extract_direct_children(data, "MONDO:0005180")
print(parkinson_children)

